!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).modelz=t()}(this,(function(){"use strict";function e(){}function t(e){return e}function r(e){return{}.toString.call(e)}function n(e){return"[object Array]"==r(e)}function o(e){return"function"==typeof e}function i(e){return"string"==typeof e}const u={construct:t,getCacheKey:e,enumerable:!0,required:!1},a={castString:!0,parseNumbers:!0,onChangeListener:function(){return e},extraProperties:!1,embedPlainData:!0,preInit:t,postInit:t,types:{}};function c({cacheKey:t}){return n(t)?e=>t.map((t=>e[t])).join("|<3|"):o(t)?t:e}return function(f){const{castString:s,debug:l,embedPlainData:d,extraProperties:p,onChangeListener:g,parseNumbers:y,postInit:b,preInit:h,types:m}={...a,...f};function P(e,r){const n={string(e){if(i(e))return e;if(s)return""+e;throw Error(`Expect a string for "${r}", got "${e}"`)},number(e){if("number"==typeof e)return e;if(i(e)&&y)return parseFloat(e);throw Error(`Expect a number for "${r}", got "${e}"`)},boolean:e=>!!e,array:e=>[...e],object:e=>({...e}),date:e=>new Date(e),identity:t,...m};if(o(e))return e;if(null==n[e])throw Error(`Try to use unknown type "${e}" as type for "${r}"`);return n[e]}function j(e,t){if(null!==(u=e)&&"[object Object]"===r(u)){if(o(e.construct))return e;if(i(e.type))return{construct:P(e.type,t),...e};if(o(e.get))return{getCacheKey:c(e),get:e.get,set:e.set,enumerable:e.enumerable||!1}}var u;if(n(e)&&2===e.length){const[r,n]=e;return{construct:P(r,t),required:n}}if(n(e)&&3===e.length){const[r,n,o]=e;return{construct:P(r,t),required:n,default:o}}if(o(e))return{construct:e};if(i(e))try{return{construct:P(e,t)}}catch(e){}try{return{construct:P(typeof e,t),required:!0,default:e}}catch(t){throw new Error(`No proper config handler found for config:\n${JSON.stringify(e)}`)}}return function(t,r){const n=(r={embedPlainData:d,extraProperties:p,preInit:h,postInit:b,onChangeListener:g,...r}).name?r.name:"instance",i={modelName:n};return function(a={}){if(l&&l.extend("create")(`constructing ${n} with data %O`,a),a._schema===i)return a;const c={};let f=e,s={};if(r.extraProperties)s={...a};else if(l){const e=Object.keys(t),r=Object.keys(a).filter((t=>!e.includes(t)));r.length&&l.extend("warn")(`The properties %o are not defined on target ${n} and will therefore be dropped.`,r)}r.embedPlainData&&Object.defineProperty(s,"_data",{get:()=>c,enumerable:!1}),Object.defineProperty(s,"_isInitialized",{get:()=>!0,enumerable:!1}),Object.defineProperty(s,"_schema",{get:()=>i,enumerable:!1}),s=r.preInit(s),f=r.onChangeListener(s);for(const e in t){const r={...u,...j(t[e],e)};if(Object.defineProperty(s,e,{enumerable:r.enumerable,get:function(){if(r.get){const t=r.getCacheKey(s);return c.hasOwnProperty(e)&&null!=t&&t===c[e].key||(c[e]={key:t,value:r.get(s)}),c[e].value}return s._data[e]},set:function(t){const n=s[e];o(r.set)?r.set(s,t):r.required||null!=t?c[e]=r.construct(t,s,r):c[e]=t=null,f(e,t,n)}}),null!=a[e])s[e]=a[e];else if(r.hasOwnProperty("default"))o(r.default)?s[e]=r.default(a):s[e]=r.default;else{if(r.required)throw Error("No value set for "+e);r.get||(s[e]=null)}}return s=r.postInit(s),p||Object.seal(s),s}}}}));
//# sourceMappingURL=modelz.min.js.map
